<!DOCTYPE html>
<html lang="ru">
<head>
  {% load static %}
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WB Ops ¬∑ –ü–∞–Ω–µ–ª—å</title>
  <!-- –û–±—â–∏–µ —Å—Ç–∏–ª–∏ —Ñ–æ–Ω–∞/—Å–∞–π—Ç–∞ (–∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π) -->
  <link rel="stylesheet" href="{% static 'css/bg.css' %}">
  <link rel="stylesheet" href="{% static 'css/home.css' %}">
  <!-- –°—Ç–∏–ª–∏ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>

  <!-- BG -->
  <div class="bg">
    <canvas class="matrix-layer" data-depth="0.04"></canvas>
    <canvas class="matrix-layer" data-depth="0.08"></canvas>
    <canvas class="matrix-layer" data-depth="0.14"></canvas>
    <div class="bg-overlay"></div>
  </div>

  <!-- –õ—ç–π–∞—É—Ç -->
  <div class="dash-root">
    <!-- SIDEBAR -->
    <aside class="dash-aside" id="dashAside">
      <div class="aside-head">
        <a class="brand" href="/">
            <span class="wb">WB</span><span class="ops"> OPS</span>
        </a>
        <button class="aside-toggle" id="asideToggle" aria-label="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å"><i data-feather="sidebar"></i></button>
      </div>

      <nav class="aside-nav">
        <a href="{% url 'bdds_page' %}"
     class="nav-item"
     title="BDDS">
    <i data-feather="bar-chart-2"></i>
    <span class="label">BDDS</span>
  </a>
  <a href="{% url 'unit_page' %}"
   class="nav-item"
   title="–Æ–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫–∞">
  <i data-feather="percent"></i>
  <span class="label">–Æ–Ω–∏—Ç-–≠–∫–æ–Ω–æ–º–∏–∫–∞</span>
</a>
        <a class="nav-item is-active" href="#"><i data-feather="grid"></i><span>–û–±–∑–æ—Ä</span></a>
        <a class="nav-item" href="/ff/boxes/"><i data-feather="package"></i><span>–§—É–ª—Ñ–∏–ª–º–µ–Ω—Ç</span></a>
        <a class="nav-item" href="/analytics/"><i data-feather="bar-chart-2"></i><span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span></a>
        <a class="nav-item" href="/seo/"><i data-feather="type"></i><span>SEO / –ö–∞—Ä—Ç–æ—á–∫–∏</span></a>
        <a class="nav-item" href="/inventory/"><i data-feather="database"></i><span>–û—Å—Ç–∞—Ç–∫–∏</span></a>
        <a class="nav-item" href="/settings/"><i data-feather="settings"></i><span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></a>
      </nav>

      <div class="aside-foot">
        <a class="nav-item" href="/help/"><i data-feather="help-circle"></i><span>–°–ø—Ä–∞–≤–∫–∞</span></a>
        <a class="nav-item" href="/accounts/logout/"><i data-feather="log-out"></i><span>–í—ã–π—Ç–∏</span></a>
      </div>
    </aside>

    <!-- MAIN -->
    <div class="dash-main">
      <!-- TOPBAR -->
      <header class="dash-top">
        <button class="burger" id="burgerBtn" aria-label="–ú–µ–Ω—é"><i data-feather="menu"></i></button>
        <div class="search">
          <i data-feather="search"></i>
          <input type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ SKU, BOX, –∑–∞–∫–∞–∑–∞–º‚Ä¶">
        </div>
        <div class="top-actions">
          <button class="icon-btn" id="notifyBtn" title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"><i data-feather="bell"></i></button>
          <div class="user">
            <div class="avatar" title="–ü—Ä–æ—Ñ–∏–ª—å">AO</div>
            <div class="menu">
              <a href="/profile/"><i data-feather="user"></i> –ü—Ä–æ—Ñ–∏–ª—å</a>
              <a href="/accounts/logout/"><i data-feather="log-out"></i> –í—ã–π—Ç–∏</a>
            </div>
          </div>
        </div>
      </header>

      <!-- CONTENT -->
      <main class="dash-content">
        <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <section class="glass card hero">
          <div class="hero-text">
            <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h1>
            <p class="muted">–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –§–§, –æ—Å—Ç–∞—Ç–∫–∞–º, –∞–Ω–∞–ª–∏—Ç–∏–∫–µ –∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º.</p>
            <div class="actions">
              <a class="btn" id="openBoxModal"><i data-feather="plus-circle"></i>–°–æ–∑–¥–∞—Ç—å BOX</a>
              <a class="btn btn-ghost" href="/analytics/"><i data-feather="activity"></i>–û—Ç–∫—Ä—ã—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É</a>
            </div>
          </div>
          <ul class="hero-stats">
            <li><i data-feather="shopping-bag"></i><span class="kpi">128</span><small>–∑–∞–∫–∞–∑–æ–≤ —Å–µ–≥–æ–¥–Ω—è</small></li>
            <li><i data-feather="package"></i><span class="kpi">42</span><small>BOX –≤ —Ä–∞–±–æ—Ç–µ</small></li>
            <li><i data-feather="dollar-sign"></i><span class="kpi">1.3–ú</span><small>–≤—ã—Ä—É—á–∫–∞, ‚ÇΩ</small></li>
            <li><i data-feather="alert-triangle"></i><span class="kpi warn">5</span><small>–∞–ª–µ—Ä—Ç–æ–≤</small></li>
          </ul>
        </section>

        <!-- KPI –±–ª–æ–∫–∏ -->
        <section class="grid-4 kpis">
          <article class="glass mini-kpi">
            <header><i data-feather="truck"></i><span>–û—Ç–≥—Ä—É–∑–∫–∏</span></header>
            <div class="val">+18%</div><small class="muted">–∫ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ</small>
          </article>
          <article class="glass mini-kpi">
            <header><i data-feather="trending-up"></i><span>CTR –∫–∞—Ä—Ç–æ—á–µ–∫</span></header>
            <div class="val">3.9%</div><small class="muted">A/B —Ç–µ—Å—Ç #21</small>
          </article>
          <article class="glass mini-kpi">
            <header><i data-feather="target"></i><span>–ú–∞—Ä–∂–∞ / SKU</span></header>
            <div class="val">27%</div><small class="muted">—Ç–æ–ø-20 SKU</small>
          </article>
          <article class="glass mini-kpi">
            <header><i data-feather="clock"></i><span>–û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å</span></header>
            <div class="val">14–¥</div><small class="muted">—Å—Ä–µ–¥–Ω—è—è –ø–æ —Å–∫–ª–∞–¥—É</small>
          </article>
        </section>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
        <section class="glass card ops">
          <h2>–û–ø–µ—Ä–∞—Ü–∏–∏</h2>
          <div class="ops-grid">
            <a class="quick" href="/ff/boxes/"><i data-feather="qr-code"></i><span>–°–∫–∞–Ω-—Ä–µ–∂–∏–º BOX</span></a>
            <button class="quick" id="importBtn"><i data-feather="upload-cloud"></i><span>–ò–º–ø–æ—Ä—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ (CSV/Excel)</span></button>
            <a class="quick" href="/seo/"><i data-feather="edit-3"></i><span>SEO-—à–∞–±–ª–æ–Ω—ã –∫–∞—Ä—Ç–æ—á–µ–∫</span></a>
            <a class="quick" href="/analytics/"><i data-feather="bar-chart"></i><span>–Æ–Ω–∏—Ç-—ç–∫–æ–Ω–æ–º–∏–∫–∞</span></a>
          </div>
        </section>

        <!-- –õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π + –¢–∞–±–ª–∏—Ü–∞ -->
        <section class="grid-2">
          <article class="glass card feed">
            <h2>–°–æ–±—ã—Ç–∏—è</h2>
            <ul class="timeline">
              <li><span class="dot ok"></span><div><b>BOX #A-342</b> –∑–∞–∫—Ä—ã—Ç –∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–∞ –æ—Ç–≥—Ä—É–∑–∫—É</div><time>10:24</time></li>
              <li><span class="dot warn"></span><div>–î–µ—Ñ–∏—Ü–∏—Ç <b>SKU 117-BLK</b> ‚Äî –æ—Å—Ç–∞—Ç–æ–∫ &lt; 5</div><time>09:58</time></li>
              <li><span class="dot"></span><div>–ò–º–ø–æ—Ä—Ç –ø—Ä–æ–¥–∞–∂ –∑–∞ –≤—á–µ—Ä–∞ –∑–∞–≤–µ—Ä—à—ë–Ω</div><time>09:12</time></li>
              <li><span class="dot ok"></span><div>A/B –∫–∞—Ä—Ç–æ—á–∫–∏ <b>KM-Serum</b>: CTR +0.6 –ø.–ø.</div><time>08:40</time></li>
            </ul>
          </article>

          <article class="glass card table-card">
            <div class="table-head">
              <h2>–û—Ç–∫—Ä—ã—Ç—ã–µ BOX</h2>
              <div class="filters">
                <input type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ BOX / SKU‚Ä¶">
                <select>
                  <option>–í—Å–µ</option>
                  <option>Open</option>
                  <option>Closed</option>
                  <option>Shipped</option>
                </select>
              </div>
            </div>
            <div class="table-wrap">
              <table class="tbl">
                <thead>
                  <tr>
                    <th>BOX</th><th>SKU</th><th>–®—Ç—Ä–∏—Ö–∫–æ–¥</th><th>–°—Ç–∞—Ç—É—Å</th><th>–û–±–Ω–æ–≤–ª—ë–Ω</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td>A-342</td><td>117-BLK</td><td>2000012345678</td><td><span class="tag t-open">open</span></td><td>10:22</td></tr>
                  <tr><td>A-340</td><td>221-GRN</td><td>2000012345612</td><td><span class="tag t-closed">closed</span></td><td>09:50</td></tr>
                  <tr><td>A-339</td><td>991-SET</td><td>2000012345699</td><td><span class="tag t-ship">shipped</span></td><td>09:10</td></tr>
                  <tr><td>A-338</td><td>117-BLK</td><td>2000012345688</td><td><span class="tag t-open">open</span></td><td>08:55</td></tr>
                </tbody>
              </table>
            </div>
          </article>
        </section>
      </main>

      <!-- FOOTER -->
      <footer class="site-footer">
        <div class="wrap">
          <div><span>–°–æ–∑–¥–∞–ª —Å –ª—é–±–æ–≤—å—é</span> <span class="heart">‚ù§Ô∏è</span> <strong>A1zy</strong></div>
          <a class="link" href="https://t.me/A1zy" target="_blank" rel="noopener"><i data-feather="send"></i><span>–ú–æ–π Telegram</span></a>
        </div>
      </footer>
    </div>
  </div>

  <!-- –ú–û–î–ê–õ –°–æ–∑–¥–∞—Ç—å BOX -->
  <div class="modal" id="boxModal" aria-hidden="true" hidden>
    <div class="modal__backdrop" data-close></div>
    <div class="modal__dialog glass">
      <div class="modal__head">
        <h3><i data-feather="plus-circle"></i> –°–æ–∑–¥–∞—Ç—å BOX</h3>
        <button class="icon-btn" data-close aria-label="–ó–∞–∫—Ä—ã—Ç—å"><i data-feather="x"></i></button>
      </div>
      <form class="modal__body">
        <label class="fi"><span>–ù–∞–∑–≤–∞–Ω–∏–µ</span><input type="text" placeholder="–ù–∞–ø—Ä. A-343" required></label>
        <label class="fi"><span>–û–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª-–≤–æ</span><input type="number" min="1" step="1" placeholder="–ù–∞–ø—Ä. 24"></label>
        <div class="modal__actions">
          <button type="button" class="btn btn-ghost" data-close>–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
      </form>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast" hidden><i data-feather="check-circle"></i><span>–ì–æ—Ç–æ–≤–æ</span></div>
 <script src="{%statik 'js/bd.js%'}"></script>
  <!-- –ò–∫–æ–Ω–∫–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ -->
  <script>
  // –ò–∫–æ–Ω–∫–∏ Feather (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å)
  if (window.feather) feather.replace({ class: 'i' });

  // ===== –ü–∞–Ω–µ–ª—å —Å–ª–µ–≤–∞: –∫–æ–ª–ª–∞–ø—Å / –±—É—Ä–≥–µ—Ä =====
  const aside = document.getElementById('dashAside');
  const root  = document.querySelector('.dash-root');
  const asideToggleBtn = document.getElementById('asideToggle');
  const burgerBtn      = document.getElementById('burgerBtn');

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–ª–ª–∞–ø—Å–∞: –∏ –Ω–∞ .dash-root, –∏ –Ω–∞ aside (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
  asideToggleBtn?.addEventListener('click', () => {
    root.classList.toggle('is-collapsed');
    aside.classList.toggle('is-collapsed');
  });

  // –ú–æ–±–∏–ª—å–Ω—ã–π ¬´–≤—ã–¥–≤–∏–∂–Ω–æ–π¬ª —Å–∞–π–¥–±–∞—Ä
  burgerBtn?.addEventListener('click', () => {
    aside.classList.toggle('is-open');
  });

  // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞ —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö ‚Äî —Å—Ä–∞–∑—É –∫–æ–ª–ª–∞–ø—Å
  if (window.matchMedia('(max-width: 980px)').matches) {
    root.classList.add('is-collapsed');
    aside.classList.add('is-collapsed');
  }

  // ===== –î—Ä–æ–ø–¥–∞—É–Ω –ø—Ä–æ—Ñ–∏–ª—è =====
  const user = document.querySelector('.user');
  user?.addEventListener('click', () => user.classList.toggle('open'));
  document.addEventListener('click', (e)=>{
    if (!user) return;
    if (!e.target.closest('.user')) user.classList.remove('open');
  });

  // ===== –ú–æ–¥–∞–ª ¬´–°–æ–∑–¥–∞—Ç—å BOX¬ª =====
  const boxModal = document.getElementById('boxModal');
  const openBox  = document.getElementById('openBoxModal');
  const toast    = document.getElementById('toast');

  function openModal(m){
    if (!m) return;
    m.hidden = false;
    requestAnimationFrame(()=>{ m.classList.add('is-open'); m.setAttribute('aria-hidden','false'); });
  }
  function closeModal(m){
    if (!m) return;
    m.classList.remove('is-open'); m.setAttribute('aria-hidden','true');
    setTimeout(()=> m.hidden = true, 180);
  }
  function showToast(text){
    if (!toast) return;
    toast.querySelector('span').textContent = text || '–ì–æ—Ç–æ–≤–æ';
    toast.hidden = false;
    requestAnimationFrame(()=> toast.classList.add('show'));
    setTimeout(()=>{ toast.classList.remove('show'); setTimeout(()=> toast.hidden = true, 200); }, 2000);
  }

  openBox?.addEventListener('click', ()=> openModal(boxModal));
  boxModal?.querySelectorAll('[data-close]').forEach(el => el.addEventListener('click', ()=> closeModal(boxModal)));
  boxModal?.addEventListener('click', (e)=>{ if (e.target.dataset.close !== undefined) closeModal(boxModal); });
  boxModal?.querySelector('form')?.addEventListener('submit', (e)=>{
    e.preventDefault();
    closeModal(boxModal);
    showToast('BOX —Å–æ–∑–¥–∞–Ω');
  });

  // –ö–Ω–æ–ø–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–∏–º–µ—Ä —Ç–æ—Å—Ç–∞
  document.getElementById('notifyBtn')?.addEventListener('click', ()=> showToast('–ù–µ—Ç –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π'));
</script>
</body>
</html>
